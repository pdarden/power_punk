import { encodeFunctionData, parseUnits, encodeDeployData } from "viem";
import CoopEscrowABI from "./abi/CoopEscrow.json";
import ProjectRegistryABI from "./abi/ProjectRegistry.json";
import registryConfig from "./registry.json";
import {
  CoopEscrowDeployParams,
  ContributionParams,
  FinalizationParams,
  NETWORK_CONFIG,
} from "./types";

// Contract ABIs from deployed contracts
export const COOP_ESCROW_ABI = CoopEscrowABI;
export const PROJECT_REGISTRY_ABI = ProjectRegistryABI;

// CoopEscrow bytecode for contract deployment
export const COOP_ESCROW_BYTECODE =
  "0x6101406040526040516121d63803806121d683398181016040528101906100269190610581565b60015f819055505f73ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff16148061009257505f73ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff16145b156100c9576040517fa86b651200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f8414806100e15750428367ffffffffffffffff1611155b15610118576040517fa86b651200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f8211801561012657505f81115b801561013157508181105b15610168576040517fa86b651200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b8573ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff16815250508473ffffffffffffffffffffffffffffffffffffffff1660c08173ffffffffffffffffffffffffffffffffffffffff16815250508360e081815250508267ffffffffffffffff166101008167ffffffffffffffff16815250508161012081815250503373ffffffffffffffffffffffffffffffffffffffff1660a08173ffffffffffffffffffffffffffffffffffffffff16815250505f8111156103055761026933308360805173ffffffffffffffffffffffffffffffffffffffff1661039060201b909392919060201c565b8060055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550806002819055503373ffffffffffffffffffffffffffffffffffffffff167ffa35a310d7113dddce1c275da946348e9aaebf9050b00b372033c4d84b0bd6eb826002546040516102fc929190610619565b60405180910390a25b8473ffffffffffffffffffffffffffffffffffffffff168673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fd4d4756f2ccb3e4c8ed7742f713631099222126d4c67c1db1a02f6700cb256a987878760405161037d9392919061064f565b60405180910390a45050505050506106e1565b610412848573ffffffffffffffffffffffffffffffffffffffff166323b872dd8686866040516024016103c593929190610693565b604051602081830303815290604052915060e01b6020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505061041860201b60201c565b50505050565b5f5f60205f8451602086015f885af180610437576040513d5f823e3d81fd5b3d92505f519150505f821461045057600181141561046b565b5f8473ffffffffffffffffffffffffffffffffffffffff163b145b156104ad57836040517f5274afe70000000000000000000000000000000000000000000000000000000081526004016104a491906106c8565b60405180910390fd5b50505050565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6104e0826104b7565b9050919050565b6104f0816104d6565b81146104fa575f5ffd5b50565b5f8151905061050b816104e7565b92915050565b5f819050919050565b61052381610511565b811461052d575f5ffd5b50565b5f8151905061053e8161051a565b92915050565b5f67ffffffffffffffff82169050919050565b61056081610544565b811461056a575f5ffd5b50565b5f8151905061057b81610557565b92915050565b5f5f5f5f5f5f60c0878903121561059b5761059a6104b3565b5b5f6105a889828a016104fd565b96505060206105b989828a016104fd565b95505060406105ca89828a01610530565b94505060606105db89828a0161056d565b93505060806105ec89828a01610530565b92505060a06105fd89828a01610530565b9150509295509295509295565b61061381610511565b82525050565b5f60408201905061062c5f83018561060a565b610639602083018461060a565b9392505050565b61064981610544565b82525050565b5f6060820190506106625f83018661060a565b61066f6020830185610640565b61067c604083018461060a565b949350505050565b61068d816104d6565b82525050565b5f6060820190506106a65f830186610684565b6106b36020830185610684565b6106c0604083018461060a565b949350505050565b5f6020820190506106db5f830184610684565b92915050565b60805160a05160c05160e0516101005161012051611a4c61078a5f395f8181610d8e01528181610e4f01528181611216015261123f01525f81816107f20152818161087c015261117801525f8181610673015281816108400152610e2301525f818161070a015261081c01525f81816105400152818161056c0152610dcc01525f818161072c01528181610b4d0152818161106c015281816112a001526113b50152611a4c5ff3fe608060405260043610610143575f3560e01c8063597e1fb5116100b5578063b5545a3c1161006e578063b5545a3c14610434578063b557478a1461044a578063c1cbbca714610486578063ecf5ac89146104ae578063fc0c546a146104d8578063fc7e286d1461050257610144565b8063597e1fb5146103125780635c99d8cc1461033c57806365c2944e146103785780636cff7473146103b657806371e28126146103e0578063aaffadf31461040a57610144565b80632ddbd13a116101075780632ddbd13a1461021857806338af3eed14610242578063401938831461026c57806347535d7b146102965780634fef2772146102c0578063590e1ae3146102fc57610144565b806302d05d3f1461014857806305261aea14610172578063058d10971461019a5780630b93381b146101c457806329dcb0cf146101ee57610144565b5b5f5ffd5b348015610153575f5ffd5b5061015c61053e565b6040516101699190611614565b60405180910390f35b34801561017d575f5ffd5b5061019860048036038101906101939190611664565b610562565b005b3480156101a5575f5ffd5b506101ae6107d9565b6040516101bb919061169e565b60405180910390f35b3480156101cf575f5ffd5b506101d86107df565b6040516101e591906116d1565b60405180910390f35b3480156101f9575f5ffd5b506102026107f0565b60405161020f919061170c565b60405180910390f35b348015610223575f5ffd5b5061022c610814565b604051610239919061169e565b60405180910390f35b34801561024d575f5ffd5b5061025661081a565b6040516102639190611614565b60405180910390f35b348015610277575f5ffd5b5061028061083e565b60405161028d919061169e565b60405180910390f35b3480156102a1575f5ffd5b506102aa610862565b6040516102b791906116d1565b60405180910390f35b3480156102cb575f5ffd5b506102e660048036038101906102e1919061174f565b6108ae565b6040516102f3919061169e565b60405180910390f35b348015610307575f5ffd5b506103106109f8565b005b34801561031d575f5ffd5b50610326610bea565b60405161033391906116d1565b60405180910390f35b348015610347575f5ffd5b50610362600480360381019061035d919061174f565b610bfc565b60405161036f919061169e565b60405180910390f35b348015610383575f5ffd5b5061039e6004803603810190610399919061174f565b610c42565b6040516103ad9392919061177a565b60405180910390f35b3480156103c1575f5ffd5b506103ca610d8b565b6040516103d7919061169e565b60405180910390f35b3480156103eb575f5ffd5b506103f4610db2565b60405161040191906116d1565b60405180910390f35b348015610415575f5ffd5b5061041e610e4d565b60405161042b919061169e565b60405180910390f35b34801561043f575f5ffd5b50610448610e71565b005b348015610455575f5ffd5b50610470600480360381019061046b919061174f565b61110b565b60405161047d91906116d1565b60405180910390f35b348015610491575f5ffd5b506104ac60048036038101906104a79190611664565b611128565b005b3480156104b9575f5ffd5b506104c26113ad565b6040516104cf919061169e565b60405180910390f35b3480156104e3575f5ffd5b506104ec6113b3565b6040516104f9919061180a565b60405180910390f35b34801561050d575f5ffd5b506105286004803603810190610523919061174f565b6113d7565b604051610535919061169e565b60405180910390f35b7f000000000000000000000000000000000000000000000000000000000000000081565b61056a6113ec565b7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146105ef576040517f93687c0b00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60015f9054906101000a900460ff1615610635576040517f9acb7e5200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600254811115610671576040517f3d19505300000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b7f00000000000000000000000000000000000000000000000000000000000000008110156106cb576040517fac691fcb00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6001805f6101000a81548160ff0219169083151502179055508060038190555060018060016101000a81548160ff0219169083151502179055506107707f0000000000000000000000000000000000000000000000000000000000000000827f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff166114309092919063ffffffff16565b8060025461077e9190611850565b6004819055507fc317509ac718196e85965c0f9c795f858acbfefbd06fcd9e92b9b6efe8a77e5b60018054906101000a900460ff16826002546040516107c69392919061177a565b60405180910390a16107d66114af565b50565b60045481565b60018054906101000a900460ff1681565b7f000000000000000000000000000000000000000000000000000000000000000081565b60025481565b7f000000000000000000000000000000000000000000000000000000000000000081565b7f000000000000000000000000000000000000000000000000000000000000000081565b5f60015f9054906101000a900460ff161580156108a957507f000000000000000000000000000000000000000000000000000000000000000067ffffffffffffffff164211155b905090565b5f60015f9054906101000a900460ff1615806108d5575060018054906101000a900460ff16155b80610926575060065f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff165b8061096d57505f60055f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054145b1561097a575f90506109f3565b5f600454148061098b57505f600254145b15610998575f90506109f3565b60025460045460055f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20546109e69190611883565b6109f091906118f1565b90505b919050565b610a006113ec565b60015f9054906101000a900460ff16610a45576040517f8b4b52de00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60018054906101000a900460ff1615610a8a576040517f2f5f932a00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f60055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205490505f8103610b04576040517f3a6a68b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f60055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2081905550610b9133827f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff166114309092919063ffffffff16565b3373ffffffffffffffffffffffffffffffffffffffff167fd7dee2702d63ad89917b6a4da9981c90c4d24f8c2bdfd64c604ecae57d8d065182604051610bd7919061169e565b60405180910390a250610be86114af565b565b60015f9054906101000a900460ff1681565b5f60055f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20549050919050565b5f5f5f60055f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054905060018054906101000a900460ff1615610d6f5760065f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16925082610d66573073ffffffffffffffffffffffffffffffffffffffff16634fef2772856040518263ffffffff1660e01b8152600401610d229190611614565b602060405180830381865afa158015610d3d573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610d619190611935565b610d68565b5f5b9150610d84565b5f8114925082610d7f5780610d81565b5f5b91505b9193909250565b5f7f0000000000000000000000000000000000000000000000000000000000000000905090565b5f60015f9054906101000a900460ff16158015610e1a57507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b8015610e4857507f000000000000000000000000000000000000000000000000000000000000000060025410155b905090565b7f000000000000000000000000000000000000000000000000000000000000000081565b610e796113ec565b60015f9054906101000a900460ff16610ebe576040517f8b4b52de00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60018054906101000a900460ff16610ed4575f5ffd5b60065f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff1615610f55576040517f3a6a68b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f60055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205490505f8103610fcf576040517f3a6a68b100000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600160065f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff0219169083151502179055505f5f90505f60045411801561103a57505f600254115b1561105d57600254600454836110509190611883565b61105a91906118f1565b90505b5f8111156110ff576110b033827f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff166114309092919063ffffffff16565b3373ffffffffffffffffffffffffffffffffffffffff167fd7dee2702d63ad89917b6a4da9981c90c4d24f8c2bdfd64c604ecae57d8d0651826040516110f6919061169e565b60405180910390a25b50506111096114af565b565b6006602052805f5260405f205f915054906101000a900460ff1681565b6111306113ec565b60015f9054906101000a900460ff1615611176576040517f9acb7e5200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b7f000000000000000000000000000000000000000000000000000000000000000067ffffffffffffffff164211156111da576040517f81efbd8d00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f8103611213576040517fa86b651200000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f7f000000000000000000000000000000000000000000000000000000000000000011801561126157507f000000000000000000000000000000000000000000000000000000000000000081105b15611298576040517f860b82a900000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b6112e53330837f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff166114b8909392919063ffffffff16565b8060055f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8282546113319190611960565b925050819055508060025f8282546113499190611960565b925050819055503373ffffffffffffffffffffffffffffffffffffffff167ffa35a310d7113dddce1c275da946348e9aaebf9050b00b372033c4d84b0bd6eb8260025460405161139a929190611993565b60405180910390a26113aa6114af565b50565b60035481565b7f000000000000000000000000000000000000000000000000000000000000000081565b6005602052805f5260405f205f915090505481565b60025f5403611427576040517f3ee5aeb500000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b60025f81905550565b6114aa838473ffffffffffffffffffffffffffffffffffffffff1663a9059cbb85856040516024016114639291906119ba565b604051602081830303815290604052915060e01b6020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505061153a565b505050565b60015f81905550565b611534848573ffffffffffffffffffffffffffffffffffffffff166323b872dd8686866040516024016114ed939291906119e1565b604051602081830303815290604052915060e01b6020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505061153a565b50505050565b5f5f60205f8451602086015f885af180611559576040513d5f823e3d81fd5b3d92505f519150505f821461157257600181141561158d565b5f8473ffffffffffffffffffffffffffffffffffffffff163b145b156115cf57836040517f5274afe70000000000000000000000000000000000000000000000000000000081526004016115c69190611614565b60405180910390fd5b50505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6115fe826115d5565b9050919050565b61160e816115f4565b82525050565b5f6020820190506116275f830184611605565b92915050565b5f5ffd5b5f819050919050565b61164381611631565b811461164d575f5ffd5b50565b5f8135905061165e8161163a565b92915050565b5f602082840312156116795761167861162d565b5b5f61168684828501611650565b91505092915050565b61169881611631565b82525050565b5f6020820190506116b15f83018461168f565b92915050565b5f8115159050919050565b6116cb816116b7565b82525050565b5f6020820190506116e45f8301846116c2565b92915050565b5f67ffffffffffffffff82169050919050565b611706816116ea565b82525050565b5f60208201905061171f5f8301846116fd565b92915050565b61172e816115f4565b8114611738575f5ffd5b50565b5f8135905061174981611725565b92915050565b5f602082840312156117645761176361162d565b5b5f6117718482850161173b565b91505092915050565b5f60608201905061178d5f8301866116c2565b61179a602083018561168f565b6117a7604083018461168f565b949350505050565b5f819050919050565b5f6117d26117cd6117c8846115d5565b6117af565b6115d5565b9050919050565b5f6117e3826117b8565b9050919050565b5f6117f4826117d9565b9050919050565b611804816117ea565b82525050565b5f60208201905061181d5f8301846117fb565b92915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f61185a82611631565b915061186583611631565b925082820390508181111561187d5761187c611823565b5b92915050565b5f61188d82611631565b915061189883611631565b92508282026118a681611631565b915082820484148315176118bd576118bc611823565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f6118fb82611631565b915061190683611631565b925082611916576119156118c4565b5b828204905092915050565b5f8151905061192f8161163a565b92915050565b5f6020828403121561194a5761194961162d565b5b5f61195784828501611921565b91505092915050565b5f61196a82611631565b915061197583611631565b925082820190508082111561198d5761198c611823565b5b92915050565b5f6040820190506119a65f83018561168f565b6119b3602083018461168f565b9392505050565b5f6040820190506119cd5f830185611605565b6119da602083018461168f565b9392505050565b5f6060820190506119f45f830186611605565b611a016020830185611605565b611a0e604083018461168f565b94935050505056fea2646970667358221220032cc0447b2dc6731cf09f1c3e2c56f89c62431dd7d03ca05e613954356a9c3664736f6c634300081c0033" as `0x${string}`;

// Get deployed contract addresses from registry
export function getDeployedContracts(
  isTestnet: boolean = process.env.NODE_ENV !== "production",
) {
  const network = isTestnet ? "baseSepolia" : "base";
  return registryConfig[network]?.contracts || {};
}

// Helper to get network config based on environment
export function getNetworkConfig() {
  // Use testnet for development, mainnet for production
  const isProduction = process.env.NODE_ENV === "production";
  return isProduction
    ? NETWORK_CONFIG.BASE_MAINNET
    : NETWORK_CONFIG.BASE_SEPOLIA;
}

// Create contract deployment transaction (following Integration.ts pattern)
export function createEscrowDeploymentTransaction(
  params: CoopEscrowDeployParams,
) {
  const networkConfig = getNetworkConfig();

  // Encode constructor parameters
  const constructorData = encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "constructor" as any,
    args: [
      params.token,
      params.beneficiary,
      params.goal,
      params.deadline,
      params.minContribution,
      params.creatorContribution,
    ],
  });

  // Combine bytecode with constructor parameters
  const deployData = (COOP_ESCROW_BYTECODE +
    constructorData.slice(2)) as `0x${string}`;

  return {
    to: undefined, // Contract deployment
    data: deployData,
    gas: BigInt(2000000), // 2M gas for deployment
    chainId: networkConfig.chainId,
    type: "eip1559" as const,
  };
}

// Encode project creation in registry
export function encodeProjectCreation(
  ensName: string,
  escrowAddress: string,
  metaURI: string,
): `0x${string}` {
  return encodeFunctionData({
    abi: PROJECT_REGISTRY_ABI,
    functionName: "createProject",
    args: [ensName, escrowAddress, metaURI],
  }) as `0x${string}`;
}

// Encode contribution function call
export function encodeContribution(amount: bigint): `0x${string}` {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "contribute",
    args: [amount],
  }) as `0x${string}`;
}

// Encode finalization function call
export function encodeFinalization(finalAmount: bigint): `0x${string}` {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "finalize",
    args: [finalAmount],
  }) as `0x${string}`;
}

// Encode refund claim function call
export function encodeClaimRefund(): `0x${string}` {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "claimRefund",
    args: [],
  }) as `0x${string}`;
}

// Encode full refund function call (for failed projects)
export function encodeRefund(): `0x${string}` {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "refund",
    args: [],
  }) as `0x${string}`;
}

// USDC approval encoding
export function encodeUSDCApproval(
  spender: string,
  amount: bigint,
): `0x${string}` {
  return encodeFunctionData({
    abi: [
      {
        inputs: [
          { internalType: "address", name: "spender", type: "address" },
          { internalType: "uint256", name: "amount", type: "uint256" },
        ],
        name: "approve",
        outputs: [{ internalType: "bool", name: "", type: "bool" }],
        stateMutability: "nonpayable",
        type: "function",
      },
    ],
    functionName: "approve",
    args: [spender as `0x${string}`, amount],
  }) as `0x${string}`;
}

// Utility functions for common operations
export function parseUSDCAmount(amount: string | number): bigint {
  return parseUnits(amount.toString(), 6); // USDC has 6 decimals
}

// Create project registration transaction (for deployed contracts)
export function createProjectRegistrationTransaction(
  ensName: string,
  escrowAddress: string,
  metaURI: string,
) {
  const networkConfig = getNetworkConfig();
  const registryAddress = getRegistryAddress();

  return {
    to: registryAddress as `0x${string}`,
    data: encodeProjectCreation(ensName, escrowAddress, metaURI),
    gas: BigInt(200000), // Estimated gas for project registration
    chainId: networkConfig.chainId,
    type: "eip1559" as const,
  };
}

export function createContributionTransactions(params: ContributionParams) {
  const networkConfig = getNetworkConfig();

  // First transaction: Approve USDC spending
  const approvalTx = {
    to: networkConfig.usdcAddress,
    data: encodeUSDCApproval(params.contractAddress, params.amount),
    gas: BigInt(65000),
    chainId: networkConfig.chainId,
    type: "eip1559" as const,
  };

  // Second transaction: Contribute to escrow
  const contributionTx = {
    to: params.contractAddress,
    data: encodeContribution(params.amount),
    gas: BigInt(150000),
    chainId: networkConfig.chainId,
    type: "eip1559" as const,
  };

  return { approvalTx, contributionTx };
}

export function createFinalizationTransaction(params: FinalizationParams) {
  const networkConfig = getNetworkConfig();

  return {
    to: params.contractAddress,
    data: encodeFinalization(params.finalAmount),
    gas: BigInt(200000),
    chainId: networkConfig.chainId,
    type: "eip1559" as const,
  };
}

// Helper function for getting registry address (only registry is pre-deployed)
export function getRegistryAddress(isTestnet?: boolean): string {
  const contracts = getDeployedContracts(isTestnet);
  return contracts.ProjectRegistry?.address || "";
}

// Contract read operations - encode read function calls
export function encodeGetProject(projectId: bigint): string {
  return encodeFunctionData({
    abi: PROJECT_REGISTRY_ABI,
    functionName: "getProject",
    args: [projectId],
  });
}

export function encodeGetEscrowTotal(): string {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "total",
    args: [],
  });
}

export function encodeGetUserContribution(userAddress: string): string {
  return encodeFunctionData({
    abi: COOP_ESCROW_ABI,
    functionName: "depositedOf",
    args: [userAddress],
  });
}
